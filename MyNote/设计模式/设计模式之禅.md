面向接口编程

# 1.六大设计模式

## 1.1单一职责原则

There should never be more than one reason for a class change.

根据职责进行划分，一个职责一个接口。

对于接口，我们在设计的时候一定要做到单一，但是对于实现类就需要多方面考虑，过分细分类的职责也会认为地增加系统的复杂性。

要求：接口一定要做到单一职责，类的设计尽量做到只有一个原因引起变化。

优点：

- 类的复杂性降低，将实现什么职责都有清晰明确的定义；
- 可读性提高，复杂性降低；
- 可维护性提高，可读性提高，
- 变更引起的风险降低，变更时必不可少的，如果接口的单一职责做的好，一个接口修改对相应的实现类有影响，地其他的接口无影响，这对系统的扩展性、维护性都有非常大的帮助。

## 1.2里氏替换原则

第一种定义，也是最正宗的定义：If for each object o1 of type S there is an object o2 of type T such that for all programs P defined in terms of T,the behavior of P is unchanged when o1 is substituted for o2 then S is a subtype of T.（如果对每一个类型为S的对象o1，都有类型为T的对象o2，使得以T定义的所有程序P在所有的对象o1都代换成o2时，程序P的行为没有发生变化，那么类型S是类型T的子类型。）

第二种定义：Functions that use pointers or references to base classes must be able to use objects of derived classes without knowing it.（所有引用基类的地方必须能透明地使用其子类的对象。）

第二个定义是最清晰明确的，通俗点讲，只要父类能出现的地方子类就可以出现，而且替换为子类也不会产生任何错误或异常，使用者可能根本就不需要知道是父类还是子类。但是，反过来就不行了，有子类出现的地方，父类未必就能适应。

最佳实践：采用里氏替换原则时，尽量避免子类的“个性”，一旦子类有个性，这个子类和父类之间的关系就很难调和了，把子类当作父类使用，子类的个性被抹杀；把子类单独作为一个业务来使用，则会让代码间的耦合关系变得扑朔迷离。

## 1.3依赖倒置原则

高层模块不应该依赖底层模块，两者都应该依赖其抽象；抽象不应该依赖细节；细节应该依赖抽象。

依赖倒置原则在Java语言中的表现就是：

- 模块键的依赖通过抽象发生，实现类之间不发生直接的依赖关系，其依赖关系时通过接口或抽象类产生的。
- 接口或抽象类不依赖于实现类
- 实现类依赖接口或抽象类

采用依赖倒置原则可以减少类间的耦合性，提高系统的稳定性，降低并行开发引起的风险，提高代码的可读性和可维护性。

最佳实践：需要遵循的规则

- 每个类尽量都有接口或抽象类，或者抽象类和接口两者都具备
- 变量的表面类型时接口或者抽象类
- 任何类都不应该从具体类派生
- 尽量不要覆写基类的方法
- 结合里氏替换原则使用

## 1.4接口隔离原则

客户端不应该依赖它不需要的接口，类间的依赖关系应该建立在最小的接口上。

可以把这两个定义概括为一句话：建立单一接口，不要建立臃肿庞大的接口。再通俗一点讲：接口尽量细化，同时接口中的方法尽量少。